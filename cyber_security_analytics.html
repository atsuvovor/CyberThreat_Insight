<head>
    <meta charset="UTF-8">
    <title>Cybersecurity Analytics</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Marked.js for Markdown ‚Üí HTML -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- MathJax for LaTeX rendering -->
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']]
        },
        svg: { fontCache: 'global' }
      };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

    <style>
    :root {
        --topbar-height: 100px;
        --footer-height: 40px;
    }

    body {
        margin: 0;
        font-family: "Segoe UI", Roboto, Arial, sans-serif;
        background: #ffffff;
        color: #222;
    }

    /* ===== Top Bar ===== */
    .topbar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: var(--topbar-height);
        background: #ffffff;
        border-bottom: 1px solid #d1d9e6;
        display: flex;
        align-items: center;
        padding: 0 15px;
        z-index: 1000;
    }

    .topbar .menu-btn {
        font-size: 22px;
        cursor: pointer;
        margin-right: 15px;
    }

    .topbar-brand {
        display: flex;
        align-items: center;
        gap: 10px;
        text-decoration: none;
        color: #0b1c2d;
    }

    .topbar-brand img {
        height: 78px;
        width: 78px;
        object-fit: contain;
        padding: 4px;
        background: #ffffff;
        border-radius: 50%;
        box-shadow: 0 0 0 1px rgba(0,0,0,0.08);
    }

    .topbar-brand span {
        font-size: 16px;
        font-weight: 600;
        white-space: nowrap;
    }

    /* ===== Top Right Buttons ===== */
    .github-btn {
        margin-left: auto;
        background: #418df0;
        color: #ffffff;
        font-size: 14px;
        font-weight: 600;
        padding: 8px 12px;
        border-radius: 6px;
        text-decoration: none;
        white-space: nowrap;
    }

    .github-btn:hover {
        background: #084298;
    }

    .powerbi-btn {
        margin-left: 10px;
        background: #0b5ed7;
        color: #ffffff;
        font-size: 14px;
        font-weight: 600;
        padding: 8px 12px;
        border-radius: 6px;
        text-decoration: none;
        white-space: nowrap;
    }

    .powerbi-btn:hover {
        background: #084298;
    }

    .support-btn {
        background: #d5e6ff;
        margin-left: 6px;
        font-size: 20px;
        cursor: pointer;
        padding: 6px 10px;
        border-radius: 6px;
    }

    .support-btn:hover {
        background: #eef5ff;
    }

    /* ===== Layout ===== */
    .container {
        display: flex;
        margin-top: var(--topbar-height);
        height: calc(100vh - var(--topbar-height) - var(--footer-height));
        overflow: hidden;
    }

    /* ===== Sidebar ===== */
    #sidebar {
        width: 280px;
        background: #ffffff;
        border-right: 1px solid #d1d9e6;
        box-shadow: 2px 0 6px rgba(0,0,0,0.08);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        transition: width 0.3s ease;
    }

    #sidebar.collapsed {
        width: 60px;
        border: none;
        box-shadow: none;
    }

    .sidebar-header {
        padding: 15px;
        border-bottom: 1px solid #eee;
        text-align: center;
    }

    .sidebar-header h2 {
        font-size: 16px;
        margin: 0;
        white-space: nowrap;
    }

    /* ===== Menu ===== */
    .menu {
        list-style: none;
        margin: 0;
        padding: 0;
        flex: 1;
        overflow-y: auto;
    }

    .menu li {
        border-bottom: 1px solid #f0f0f0;
    }

    .menu a {
        display: block;
        padding: 12px 18px;
        color: #0b1c2d;
        text-decoration: none;
        cursor: pointer;
    }

    .menu a:hover,
    .menu a.active {
        background: #eef5ff;
        color: #000066;
        font-weight: 600;
    }

    /* ===== Submenu ===== */
    .submenu {
        display: none;
        background: #ffffff;
    }

    .submenu a {
        padding-left: 35px;
        font-size: 14px;
    }

    .menu .arrow {
        display: inline-block;
        transition: transform 0.25s ease;
    }

    .menu li.open > a .arrow {
        transform: rotate(90deg);
    }

    .menu li.open .submenu {
        display: block;
    }

    /* ===== Content ===== */
    .content {
        flex: 1;
        overflow-y: auto;
        background: #ffffff;
    }

    #display-card {
        padding: 20px;
    }

    #display-card img {
        max-width: 100%;
        height: auto;
    }

    /* ===== Footer ===== */
    .footer {
        height: var(--footer-height);
        background: #ffffff;
        border-top: 1px solid #d1d9e6;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 13px;
        color: #555;
    }
    </style>
</head>


<body>

<!-- ===== Top Bar ===== -->
<div class="topbar">
    <span class="menu-btn" onclick="toggleSidebar()">‚ò∞</span>

    <!-- Logo + Title -->
    <a href="cyber_security_analytics.html" class="topbar-brand">
        <img
            src="https://raw.githubusercontent.com/atsuvovor/CyberThreat_Insight/main/images/cyber_Threat_Analytics_and_Insight_logo.png"
            alt="Cyber Threat Analytics Logo"
        />
        <span>Cyber Threat Analytics & Insight</span>
    </a>

       <!-- GitHub Button (FIRST on the right) -->
    <a class="github-btn"
       href="https://github.com/atsuvovor/CyberThreat_Insight/tree/main"
       target="_blank"
       title="Open Cyber Attack Insight Dashboard">
        üìÇ GitHub Repo
    </a>
    
    <!-- Power BI Button (second on the right) -->
    <a class="powerbi-btn"
       href="https://atsuvovor.github.io/power_bi_projects/cyber_attack_insight_dashboard.html"
       target="_blank"
       title="Open Cyber Attack Insight Dashboard">
        üìä Power BI Dashboard
    </a>

    <!-- Support Button (RIGHTMOST) -->
    <span class="support-btn"
          title="Support Cyber Threat Insight"
          onclick="toggleSupport()">
        üíô‚òï
    </span>
</div>



 <div class="container">

    <!-- ===== Sidebar ===== -->
    <div id="sidebar">
         <div class="sidebar-header" style="text-align:center;">
            <h2>Modules</h2>
        </div>

        <ul class="menu">
            <li>
                <a class="active"
                   onclick="loadDocumentation(
                       'https://raw.githubusercontent.com/atsuvovor/CyberThreat_Insight/refs/heads/main/README.md',
                       this
                   )">
                    üè† Main Page
                </a>
            </li>

            <li>
                <a onclick="loadDocumentation(
                    'https://raw.githubusercontent.com/atsuvovor/CyberThreat_Insight/refs/heads/main/datagen/README.md',
                    this
                )">
                    Data Generator
                </a>
            </li>

            <li>
                <a onclick="loadDocumentation(
                    'https://raw.githubusercontent.com/atsuvovor/CyberThreat_Insight/refs/heads/main/explanatory_data_analysis/README.md',
                    this
                )">
                    Explanatory Data Analysis
                </a>
            </li>

            <li>
                <a onclick="loadDocumentation(
                    'https://raw.githubusercontent.com/atsuvovor/CyberThreat_Insight/refs/heads/main/feature_engineering/README.md',
                    this
                )">
                    Feature Engineering
                </a>
            </li>

            <li>
                <a onclick="this.parentElement.classList.toggle('open')">
                    Model Development <span class="arrow">‚ñ∏</span>
                </a>
                <ul class="submenu">
                    <li>
                        <a onclick="loadDocumentation(
                            'https://raw.githubusercontent.com/atsuvovor/CyberThreat_Insight/refs/heads/main/model_dev/README.md',
                            this
                        )">
                            Model Overview
                        </a>
                    </li>
                    
                    <li>
                        <a onclick="loadDocumentation(
                            'https://raw.githubusercontent.com/atsuvovor/CyberThreat_Insight/refs/heads/main/model_dev/lagacy_best_model_dev/README.md',
                            this
                        )">
                            Baseline Multi-Classifier
                        </a>
                    </li>
                    <li>
                        <a onclick="loadDocumentation(
                            'https://raw.githubusercontent.com/atsuvovor/CyberThreat_Insight/refs/heads/main/model_dev/lagacy_best_model_dev_improved/README.md',
                            this
                        )">
                            Hybrid ML Approach
                        </a>
                    </li>
                    <li>
                        <a onclick="loadDocumentation(
                            'https://raw.githubusercontent.com/atsuvovor/CyberThreat_Insight/refs/heads/main/model_dev/stacked_model/README.md',
                            this
                        )">
                            Stacked Supervised Model
                        </a>
                    </li>
                </ul>
            </li>

            <li>
                <a onclick="loadDocumentation(
                    'https://raw.githubusercontent.com/atsuvovor/CyberThreat_Insight/refs/heads/main/model_inference/README.md',
                    this
                )">
                    Model Inference Simulation
                </a>
            </li>

            <li>
                <a onclick="loadDocumentation(
                    'https://raw.githubusercontent.com/atsuvovor/CyberThreat_Insight/refs/heads/main/production/README.md',
                    this
                )">
                    Production Simulation
                </a>
            </li>

            <li>
                <a onclick="loadDocumentation(
                    'https://raw.githubusercontent.com/atsuvovor/CyberThreat_Insight/refs/heads/main/cyber_attack_insight/README.md',
                    this
                )">
                    Attack Analytics Simulation
                </a>
            </li>

        </ul>
    </div>

    <!-- ===== Content ===== -->
    <div class="content">
        <div id="display-card">
            <p style="text-align:center; color:#555;">
                Select a module from the menu to load documentation.
            </p>
        </div>
    </div>

</div>
    <!-- ===== Support Cyber Threat Insight Card ===== -->
<div id="support-sidebar">
  <h4>üíô Support Cyber Threat Insight</h4>
  <p>Keep this open-source project thriving!</p>

  <a href="https://www.paypal.me/atsuvovor" target="_blank">
    PayPal (International)
  </a>

  <a href="mailto:atsu.vovor@bell.net?subject=CyberThreat%20Insight%20Support">
    Interac e-Transfer (Canada)
  </a>

  <p style="font-size:12px; color:#555; margin-top:8px;">
    Auto-deposit enabled ‚Äî no security question required
  </p>

  <p style="font-size:12px; color:#555; margin-top:12px;">
    Secure bank-to-bank transfer ‚Ä¢ No platform fees ‚Ä¢ Ideal for Canadian supporters
  </p>

  <p>
    <img src="https://img.shields.io/badge/Open%20Source-Supported-brightgreen" />
    <img src="https://img.shields.io/badge/Cybersecurity-Research-blue" />
    <img src="https://img.shields.io/badge/Enterprise-Interview%20Ready-success" />
  </p>
</div>

<script>

/* Toggle support card */
    
const supportSidebar = document.getElementById("support-sidebar");
const supportBtn = document.querySelector(".support-btn");


function trackSupportClick() {
    if (window.plausible) {
        plausible("Support Click");
    }
}

function toggleSupport(forceClose = false) {
    if (forceClose) {
        supportSidebar.classList.remove("open");
        return;
    }
    supportSidebar.classList.toggle("open");

    // Analytics tracking
    trackSupportClick();
    supportBtn.classList.remove("pulse");

}

/* ESC key closes support card */
document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") {
        toggleSupport(true);
    }
});

/* Click outside closes support card */
document.addEventListener("click", (e) => {
    if (
        supportSidebar.classList.contains("open") &&
        !supportSidebar.contains(e.target) &&
        !supportBtn.contains(e.target)
    ) {
        toggleSupport(true);
    }
});

function toggleSidebar() {
    document.getElementById("sidebar").classList.toggle("collapsed");
}


// Configure Marked.js safely (CSP-safe)
marked.setOptions({
    gfm: true,          // GitHub Flavored Markdown
    breaks: true,       // line breaks
    headerIds: true,
    smartLists: true,
    smartypants: false,
    mangle: false,      // prevents email obfuscation
    // Disallow raw HTML ‚Üí prevents eval() internally
    sanitizer: null,
    renderer: new marked.Renderer()
});

async function loadDocumentation(url, el = null) {

    let mdText = await (await fetch(url)).text();

    const BASE_IMG =
        "https://raw.githubusercontent.com/atsuvovor/CyberThreat_Insight/main/images/";

    /* -------------------------------------------------
       Fix malformed closing </p tags
    ------------------------------------------------- */
    mdText = mdText.replace(/<\/p\s*(?=<)/gi, "</p>");

    /* -------------------------------------------------
       Convert GitHub blob URLs ‚Üí raw URLs
    ------------------------------------------------- */
    mdText = mdText.replace(
       /https:\/\/github\.com\/([^\/]+)\/([^\/]+)\/blob\/([^\/]+)\/images\/([^"'\s]+)/gi,
       (_, user, repo, branch, file) =>
        `https://raw.githubusercontent.com/${user}/${repo}/${branch}/images/${file}`
    );

     /* -------------------------------------------------
          Force any GitHub image to raw
     ------------------------------------------------- */
    mdText = mdText.replace(
       /src=["']https:\/\/github\.com\/([^"']+)\/blob\/([^"']+)["']/gi,
       'src="https://raw.githubusercontent.com/$1/$2"'
    );

    /* -------------------------------------------------
       Markdown images: ![alt](images/file.png)
    ------------------------------------------------- */
    mdText = mdText.replace(
        /!\[(.*?)\]\((images\/[^)]+)\)/g,
        (_, alt, relPath) =>
            `![${alt}](${BASE_IMG}${relPath.replace("images/", "")})`
    );

    /* -------------------------------------------------
       HTML <img src="images/file.png">
    ------------------------------------------------- */
    mdText = mdText.replace(
        /<img\s+([^>]*?)src=["'](images\/[^"']+)["']([^>]*)>/gi,
        (match, pre, path, post) => {
            const newSrc = BASE_IMG + path.replace("images/", "");

            // Remove fixed dimensions
            post = post
                .replace(/width=["'][^"']+["']/gi, '')
                .replace(/height=["'][^"']+["']/gi, '');

            // Ensure responsive images
            if (!/style=/i.test(post)) {
                post += ' style="max-width:100%; height:auto;"';
            }

            return `<img ${pre}src="${newSrc}"${post}>`;
        }
    );

    /* -------------------------------------------------
       Render Markdown (CSP-safe)
    ------------------------------------------------- */
    document.getElementById("display-card").innerHTML = `
      <div style="padding:10px; max-width:1100px; margin:auto;">
          ${marked.parse(mdText)}
      </div>
    `;

    /* Render LaTeX math (MathJax) */
    if (window.MathJax) {
        MathJax.typesetPromise();
    }

    /* -------------------------------------------------
       Active menu highlight
    ------------------------------------------------- */
    document.querySelectorAll(".menu a").forEach(a =>
        a.classList.remove("active")
    );
    if (el) el.classList.add("active");
}

document.addEventListener("DOMContentLoaded", () => {
    // Set current year
    const yearSpan = document.getElementById("year");
    if (yearSpan) {
        yearSpan.textContent = new Date().getFullYear();
    }

    // Default landing page
    const mainLink = document.querySelector(".menu a");
    loadDocumentation(
        "https://raw.githubusercontent.com/atsuvovor/CyberThreat_Insight/refs/heads/main/README.md",
        mainLink
    );

    // Show support sidebar after 2.5s
    if (!sessionStorage.getItem("supportShown")) {
        setTimeout(() => {
            supportSidebar.classList.add("open");
            sessionStorage.setItem("supportShown", "true");
        }, 2500);
    }

    // Add pulse effect
    supportBtn.classList.add("pulse");
});



</script>

<!-- ===== Footer ===== -->
<div class="footer">
    ¬© <span id="year"></span> Atsu Vovor ¬∑ Cyber Security Analytics. All rights reserved.
</div>

</body>

</html>
